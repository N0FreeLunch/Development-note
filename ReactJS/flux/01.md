# Flux


### Flux란?
- 데이터를 한 방향으로 흐르게 하기 위한 패턴


### MVC 패턴
- 모델, 뷰, 컨트롤러로 구성
- flux는 MVC 모델과는 다르다!!!

### React에서 MVC 모델
- 컴포넌트에서 return으로 JSX로 화면을 구성하는 부분 => 뷰 (view)
- 상태 데이터가 저장되는 부분 => 모델 (model)
- => 컨트롤러 (Controller)

#### 뷰는 여러 모델에 따라 업데이트 된다
- 상위 컴포넌트와 하위 컴포넌트의 관계에서 상위 컴포넌트의 스테이트는 하위 컴포넌트를 랜더링하게 한다.
- 이것을 MVC 패턴으로 보면 상위 컴포넌트의 상태는 Model이며, 이 상위 컴포넌트에 영향을 받는 하위 컴포넌트는 상위 컴포넌트의 모델에 대해 뷰를 생성한다.
- 하나의 컴포넌트에 대해서 상위 컴포넌트는 여러개가 있을 수 있으며 이 여러개는 상위 하위 관계로 구성되어 있다. 
- 이 말은 하나의 컴포넌트의 랜더링은 여러 상위 컴포넌트에 영향을 받는다. 
- MVC 관점에서는 하나의 뷰는 여러 상위 컴포넌트의 모델에 따라 업데이트가 된다. 

#### 뷰는 여러 모델에 영향을 끼침
- 하위 컴포넌트는 상위 컴포넌트로 부터 상위 컴포넌트의 상태를 변경할 수 있는 함수를 전달 받을 수 있다.
- 유저의 조작이나 컴포넌트 내부에 정의한 어떤 상태 변화를 유도하는 무언가에 의해서 상위 컴포넌트에서 전달 받은 상태 변경 메서드를 통해 상위 컴포넌트의 상태를 바꿀 수 있다. 
- 하나의 컴포넌트에 대한 상위 컴포넌트는 여럿이기 때문에 이는 MVC 패턴에 따라 보면 하위 컴포넌트에서 상위 컴포넌트의 상태변경을 유도하는 어떤 이벤트 (자바스크립트의 이벤트가 아닌 개념적인 이벤트)에 의해 상위 컴포넌트의 모델의 데이터를 변경하게 된다. 

### MVC의 문제
#### MVC의 특성
- 여러 모델은 하나의 뷰를 업데이트 시킬 수 있다.
- 뷰는 여러 모델에 영향을 끼칠 수 있다.

#### MVC의 문제 이유
> a 컴포넌트는 A라는 상위 컴포넌트의 하위 컴포넌트이며 A와 a는 여러 개의 컴포넌트 계층으로 구성되어 있다.
> b 컴포넌트는 B라는 상위 컴포넌트의 하위 컴포넌트이며 B와 b는 여러 개의 컴포넌트 계층으로 구성되어 있다.
> A 와 B는 공통의 상위 컴포넌트 S를 가지고 있다.
> a 컴포넌트에는 메시지의 읽지 않은 수를 표시한다.
> b 컴포넌트에는 읽지 않는 메시지를 강조하는 목록을 표시한다. 
> b 컴포넌트의 메시지를 하나 읽게 되면, a 컴포넌트의 카운터가 1 감소해야 한다.
- b는 S의 상태를 변경해야 한다. S의 상태를 변경하게 되면S는 a를 랜더링 시키기 위해서 S와 a사이의 모든 컴포넌트를 랜더링 시킨다.
- 계단식 업데이트
- 종속성
- 데이터 흐름이 뒤엉켜 예측 불가


### Flux 패턴의 구성
- 디스패처
- 스토어
- 뷰


### 들어가기에 앞서
- 리액트는 컴포넌트가 분기 되기 시작하기 전의 최상위 계층의 컴포넌트에 변수를 저장하여 전역 변수 처럼 사용할 수 있다.

### 디스패처
- action으로 표현된다.
- 리액트의 스테이트를 업데이트 하기 위한 함수이다. 이 함수를 helper methods라고 한다.

### 뷰
- 리액트 컴포넌트를 의미한다.


### flux update cycle


### 리액트의 특징
- 리액트는 상위 컴포넌트와 하위 컴포넌트의 트리 구조로 구성되어 있으며, 최상단에 하나의 컴포넌트로 부터 하위 컴포넌트를 포함하는 방식으로 구성된다.
- 리액트는 데이터를 각 로컬 스테이트로 관리를 하거나, 상위 컴포넌트의 데이터를 하위 컴포넌트에게 전달하는 방식으로 구성한다. 
- 상위 컴포넌트에 공통적으로 데이터를 저장할 수도 있지만 컴포넌트가 분기 되기 시작하기 전의 최상위 계층의 컴포넌트에 데이터를 항상 저장하는 것이 아닌 상위 컴포넌트에 데이터를 저장하고 공유가 필요한 데이터는 하위 컴포넌트에서 상위 컴포넌트의 상태를 공유하는 방식으로 사용한다.

### 중앙 디스패처 (central dispatcher)
- 리액트 어플리케이션의 모든 데이터를 통합 관리하는 한 단위의 저장소를 중앙 디스패처라고 한다.
- 모든 데이터를 통합관리 하기 위해서는 어플리케이션의 모든 컴포넌트에 상태를 공유 상태를 전달 할 수 있어야 한다.
- 디스패처를 통해 스토어의 상태가 변하면 영향을 받는 모든 컴포넌트는 새로 랜더링(업데이트)을 하게 된다.

